# EVPN (Ethernet VPN)

**EVPN (Ethernet VPN)** — это технология для построения масштабируемых L2 VPN поверх IP-сети.

## Ключевые принципы

1.	Отделение Control Plane от Data Plane:
- Control Plane:\
Использует протокол BGP (MP-BGP) для обмена информацией о MAC-адресах.
Это заменяет традиционное "обучение" MAC-адресов широковещательным трафиком (flood-and-learn). 
- Data Plane:\
Для передачи пользовательского трафика используются инкапсуляции: MPLS, VXLAN.
2. Решает проблемы традиционных L2VPN (например, VPLS):
- Нет возможности для multihomed сайтов (сайтов, подключенных к 2-м и более PE маршрутизаторам одновременно) подключать хост к нескольким Leaf коммутаторам для повышения отказоустойчивости и балансировки нагрузки.;
- Не предоставляют расширенных функций L3, за исключением банального добавления BVI/IRB (Bridge Virtual Interface/Integrated Routing and Bridging) интерфейса в VPLS домен для выхода во внешнюю сеть;
- MAC-адреса изучаются исключительно на уровне Data Plane, что приводит к увеличению флуда BUM (Broadcast, Unknown Unicast, Multicast) трафика в сети провайдера.

3. EVPN вводит концепцию Ethernet Segment (ES), VLAN/EVI (ethernet virtual instance – то есть тут имеется в виду VNI).\
Для каждого ES один из коммутаторов становтся DF.
4. Масштабируемость:  тут речь о том, что можно мигрировать ВМ между различными лифами. Для этого используются отзыв маршрутов BGP, а затем MAC/IP advertisement. 

