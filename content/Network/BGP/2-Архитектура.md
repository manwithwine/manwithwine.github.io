# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ BGP

BGP ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ—Ç–æ–∫–æ–ª, –∞ **–∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞**, —Å–æ—Å—Ç–æ—è—â–∞—è –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ç–∞–±–ª–∏—Ü, –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π.

---

## –ê–≤—Ç–æ–Ω–æ–º–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã (AS)

–ê–≤—Ç–æ–Ω–æ–º–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ (AS) ‚Äî —ç—Ç–æ —Å–µ—Ç—å –ø–æ–¥ –µ–¥–∏–Ω—ã–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–º –∫–æ–Ω—Ç—Ä–æ–ª–µ–º, –∏—Å–ø–æ–ª—å–∑—É—é—â–∞—è –æ–±—â—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏.

- –ù–æ–º–µ—Ä AS: 16-–±–∏—Ç (1‚Äì65535) –∏–ª–∏ 32-–±–∏—Ç (1‚Äì4294967295).
- –ü—Ä–∏–º–µ—Ä: AS64500 (—á–∞—Å—Ç–Ω—ã–π), AS15169 (Google).
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ RIR (RIPE, ARIN, APNIC –∏ –¥—Ä.)

> ‚ùó –ß–∞—Å—Ç–Ω—ã–µ AS: 64512‚Äì65535 (16-bit), 4200000000‚Äì4294967294 (32-bit).

---

## BGP Routing Information Base (RIB)

BGP –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç—Ä–∏ —Ç–∞–±–ª–∏—Ü—ã:

### 1. Adj-RIB-In (Advertised Neighbor RIB ‚Äî –≤—Ö–æ–¥—è—â–∏–µ)
- –ú–∞—Ä—à—Ä—É—Ç—ã, –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –æ—Ç —Å–æ—Å–µ–¥–∞ **–¥–æ** –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø–æ–ª–∏—Ç–∏–∫–∏.
- –ú–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å: `show bgp ipv4 unicast neighbors X.X.X.X received-routes`

### 2. Loc-RIB (Locally Stored RIB)
- –í—ã–±—Ä–∞–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã **–ø–æ—Å–ª–µ** –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è `IMPORT` –ø–æ–ª–∏—Ç–∏–∫–∏.
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤ FIB (Forwarding Information Base).
- `show bgp ipv4 unicast`

### 3. Adj-RIB-Out
- –ú–∞—Ä—à—Ä—É—Ç—ã, **–æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ** —Å–æ—Å–µ–¥—É –ø–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è `EXPORT` –ø–æ–ª–∏—Ç–∏–∫–∏.
- `show bgp ipv4 unicast neighbors X.X.X.X advertised-routes`

> üîó –≠—Ç–∏ —Ç–∞–±–ª–∏—Ü—ã ‚Äî –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–µ. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–Ω—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É.

---

## –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å IGP

BGP **–Ω–µ –∑–∞–º–µ–Ω—è–µ—Ç** IGP. –û–Ω –ø–æ–ª–∞–≥–∞–µ—Ç—Å—è –Ω–∞ IGP –¥–ª—è –¥–æ—Å—Ç–∞–≤–∫–∏ –ø–∞–∫–µ—Ç–æ–≤ **–≤–Ω—É—Ç—Ä–∏ AS**.

```text
[ R1 ] ‚îÄ‚îÄeBGP‚îÄ‚îÄ> [ R2 ] ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ> [ R3 ]
                  ‚îÇ
                iBGP
                  ‚îÇ
               [ R4 ]
```
1. R2 –æ–±—ä—è–≤–ª—è–µ—Ç –ø—Ä–µ—Ñ–∏–∫—Å —á–µ—Ä–µ–∑ eBGP  
2. R2 –ø–µ—Ä–µ–¥–∞—ë—Ç –º–∞—Ä—à—Ä—É—Ç iBGP-—Å–æ—Å–µ–¥—É R4  
3. R4 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç IGP –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø—É—Ç–∏ –¥–æ NEXT_HOP (R2)  

‚ö†Ô∏è **–ö—Ä–∏—Ç–∏—á–Ω–æ:** –ï—Å–ª–∏ IGP –Ω–µ –∑–Ω–∞–µ—Ç –ø—É—Ç—å –¥–æ NEXT_HOP ‚Üí –º–∞—Ä—à—Ä—É—Ç –Ω–µ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ FIB.

---

## Next-Hop-Self

**–ü—Ä–æ–±–ª–µ–º–∞:**  
–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ iBGP –º–æ–∂–µ—Ç –Ω–∞—Ä—É—à–∞—Ç—å –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é, –∫–æ–≥–¥–∞ NEXT_HOP –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω.

**–†–µ—à–µ–Ω–∏–µ:**  
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—É `next-hop-self` –¥–ª—è –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏ NEXT_HOP –Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –∞–¥—Ä–µ—Å.

### –ü–æ—Ä—è–¥–æ–∫ –≤—ã–±–æ—Ä–∞ –º–∞—Ä—à—Ä—É—Ç–∞ (Route Selection Algorithm)

BGP –≤—ã–±–∏—Ä–∞–µ—Ç –ª—É—á—à–∏–π –ø—É—Ç—å –ø–æ —Å—Ç—Ä–æ–≥–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:

1. **Highest Weight** (Cisco only)
2. **Highest LOCAL_PREF**
3. –õ–æ–∫–∞–ª—å–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã (`network`, `aggregate`)
4. **Shortest AS_PATH**
5. **Best ORIGIN** (IGP < EGP < incomplete)
6. **Lowest MED**
7. eBGP > iBGP
8. **Lowest IGP metric** –∫ NEXT_HOP
9. **Oldest route** (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ `bgp bestpath compare-routerid`)
10. **Lowest Router-ID**
11. **Shortest Cluster-List**
12. **Lowest Neighbor Address**

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –≤–µ–Ω–¥–æ—Ä—ã (Juniper) –ø–æ–∑–≤–æ–ª—è—é—Ç –∏–∑–º–µ–Ω—è—Ç—å –ø–æ—Ä—è–¥–æ–∫ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è.

---
