# IPv6

IPv4 - 32 бита = 4 байтов
IPv6 - 128 битов = 16 байта

Записывается в 16-ом виде, каждые 4 цифры разделяются двоеточием (8 груп по 16 бит)

Как записать адрес в IPv6
1. Убираем левые нули с каждой группы (2001:0db8:0000:0000:0192:0000:0010:1000 -> 2001:db8:0000:0000:192:0000:10:1000)
2. Если группа состоит только из четырех 0 - мы оставляем только один 0 (2001:db8:0000:0000:192:0000:10:1000 -> 2001:db8:0:0:192:0:10:1000)
3. Один ноль или группа из нескольких 0 можно заменить двойным двоеточием (2001:db8:0:0:192:0:10:1000 -> 2001:db8::192:0:10:1000)
    - Важно! Можно заменить только один раз в адресе. Если в адресе несколько групп нулей, предпочтительно заменить левую группу.


Как в IPv6 выделяется подсеть?

CIDR (Classless Inter-Domain Routing) в IPv6 означает использование префиксов произвольной длины для обозначения блоков адресов IPv6, аналогично тому, как это делается в IPv4.

Адрес делится на две части:

![Адрес делится на две части:](images/network/ipv6_1.jpg)  
*Source: [Курс: Основы протокола IPv6](https://clck.ru/3MzQXh)*

Таблица с рекомендациями по размеру сетей:

![Таблица](images/network/ipv6_2.jpg)  
*Source: [Курс: Основы протокола IPv6](https://clck.ru/3MzQXh)*

Правила распределения:
1. Если на подсеть выделять 1 бит, то исходный префикс разбивается на 2 меньших, длина которых на 1 больше, чем у исходного.
2. Но лучше использовать подсети на границе 4 бит. Таким образом не потребуется никаких двоичных вычислений. Просто увеличиваете число в данной позиции от 0 до f.

![Разделение сетей](images/network/ipv6_3.jpg)  
*Source: [Курс: Основы протокола IPv6](https://clck.ru/3MzQXh)*

## Типы IPv6 адресов

1. Unicast

Адрес для одного конкретного интерфейса. Пакет отправляется только одному получателю.

- **Global Unicast (GUA)** – публичные адреса (аналог IPv4 публичных адресов).
Диапазон: 2000::/3 (всё, что начинается с 2 или 3).
Пример: 2001:db8::1

- **Unique Local (ULA)** – локальные адреса (аналог IPv4 192.168.0.0/16).
Диапазон: fc00::/7 (обычно fd00::/8).
Пример: fd12:3456:789a::1

- **Link-Local (LLA)** – адреса для связи в пределах одной подсети (аналог 169.254.0.0/16 в IPv4).
Диапазон: fe80::/10.
Пример: fe80::1 (автоматически генерируется для каждого интерфейса).

2. Multicast

Адрес для группы интерфейсов. Пакет получают все устройства, подписанные на эту группу.
Диапазон: ff00::/8.
Примеры:
- ff02::1 – все узлы в локальной сети.
- ff02::2 – все маршрутизаторы в локальной сети.
- ff02::1:ffXX:XXXX – используется для NDP (аналог ARP в IPv4).

3. Anycast

Адрес, назначенный нескольким устройствам, но пакет доставляется только ближайшему (по метрике маршрутизации).
Не имеет отдельного диапазона – это обычный Unicast-адрес, назначенный нескольким узлам.
Пример: 2001:db8::123 может быть Anycast для нескольких DNS-серверов.


4. Особые адреса
- **Неопределённый адрес** (::/128) – аналог 0.0.0.0 в IPv4.
- **Loopback** (::1/128) – аналог 127.0.0.1 (петля на самом устройстве).
- **IPv4-совместимые адреса** (устарели):
::ffff:0:0/96 (IPv4-mapped, например ::ffff:192.168.1.1).

5. Discard-Only

Это специальный зарезервированный IPv6-адрес, назначенный для "чёрной дыры".
Весь трафик, отправленный на него, должен тихо отбрасываться (без отправки ICMP-уведомлений).
Аналог null-роута в IPv4
Диапазон: 100::/64 (RFC 6666)

D протоколе IPv6 нет Broadcast!!!

